{"mappings":"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","sources":["<anon>","public/js/index.js","public/js/login.js","public/js/alerts.js","public/js/mapbox.js","public/js/updateSettings.js","public/js/stripe.js"],"sourcesContent":["require(\"@babel/polyfill\");\nvar $9cHRR$axios = require(\"axios\");\n\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n/* eslint-disable */ \n/* eslint-disable */ \n/* eslint-disable */ const $528d70b6813c5801$export$516836c6a9dfc573 = ()=>{\n    const el = document.querySelector(\".alert\");\n    if (el) el.parentElement.removeChild(el);\n};\nconst $528d70b6813c5801$export$de026b00723010c1 = (type, message, time = 7)=>{\n    $528d70b6813c5801$export$516836c6a9dfc573();\n    const markup = `<div class=\"alert alert--${type}\">${message}</div>`;\n    document.querySelector(\"body\").insertAdjacentHTML(\"afterbegin\", markup);\n    window.setTimeout($528d70b6813c5801$export$516836c6a9dfc573, time * 1000);\n};\n\n\nconst $90c6ea74aa9f1952$export$596d806903d1f59e = async (email, password)=>{\n    try {\n        const result = await (0, ($parcel$interopDefault($9cHRR$axios)))({\n            method: \"POST\",\n            url: \"/api/v1/users/login\",\n            data: {\n                email: email,\n                password: password\n            }\n        });\n        if (result.data.status === \"success\") {\n            (0, $528d70b6813c5801$export$de026b00723010c1)(\"success\", \"Successfully logged in\");\n            window.setTimeout(()=>{\n                location.assign(\"/\");\n            }, 1500);\n        }\n    } catch (err) {\n        (0, $528d70b6813c5801$export$de026b00723010c1)(\"error\", err.response.data.message);\n    }\n};\nconst $90c6ea74aa9f1952$export$a0973bcfe11b05c9 = async ()=>{\n    try {\n        const res = await (0, ($parcel$interopDefault($9cHRR$axios)))({\n            method: \"GET\",\n            url: \"/api/v1/users/logout\"\n        });\n        if (res.data.status === \"success\") location.assign(\"/\");\n    } catch (err) {\n        (0, $528d70b6813c5801$export$de026b00723010c1)(\"error\", \"Error logging out. Try again\");\n    }\n};\n\n\n/* eslint-disable */ const $f1eefc3e571ce161$export$4c5dd147b21b9176 = (locations)=>{\n    mapboxgl.accessToken = \"pk.eyJ1Ijoia2NodW1hayIsImEiOiJjbGliaDN3ZmowZGs3M3FtdGx2NGJma283In0.rCx_1fsTIq5B00zNmh_K3w\";\n    var map = new mapboxgl.Map({\n        container: \"map\",\n        style: \"mapbox://styles/kchumak/clibhc3jo02xq01png9uh6mui\",\n        scrollZoom: false\n    });\n    const bounds = new mapboxgl.LngLatBounds();\n    locations.forEach((loc)=>{\n        // Create a marker\n        const el = document.createElement(\"div\");\n        el.className = \"marker\";\n        // Add a marker\n        new mapboxgl.Marker({\n            element: el,\n            anchor: \"bottom\"\n        }).setLngLat(loc.coordinates).addTo(map);\n        // Add a popup\n        new mapboxgl.Popup({\n            offset: 30\n        }).setLngLat(loc.coordinates).setHTML(`<p>Day ${loc.day}: ${loc.description} </p>`).addTo(map);\n        // extend ma bounds to include current location\n        bounds.extend(loc.coordinates);\n    });\n    map.fitBounds(bounds, {\n        padding: {\n            top: 200,\n            bottom: 200,\n            left: 100,\n            right: 100\n        }\n    });\n};\n\n\n/* eslint-disable */ \n\nconst $57d5b9d949522b3d$export$f558026a994b6051 = async (data, type)=>{\n    console.log(data);\n    try {\n        const res = await (0, ($parcel$interopDefault($9cHRR$axios)))({\n            method: \"PATCH\",\n            url: type === \"password\" ? \"/api/v1/users/updatePassword\" : \"/api/v1/users/updateMe\",\n            data: data\n        });\n        if (res.data.status === \"success\") (0, $528d70b6813c5801$export$de026b00723010c1)(\"success\", `${type.toUpperCase()} updated successfully`);\n    } catch (err) {\n        (0, $528d70b6813c5801$export$de026b00723010c1)(\"error\", err.response.data.message);\n    }\n};\n\n\n/* eslint-disable */ \n\nconst $a3b283ce5068068c$export$8d5bdbf26681c0c2 = async (tourId)=>{\n    const stripe = Stripe(\"pk_test_51M9VYACOowI665uNB0ajKN8b4kqMTunVIJaeczMQm0RwYLzXQdkNuQOVJzCW7jSF54jtkCXG30vm0efkvnNutO3F00paMDAsCo\");\n    try {\n        // 1) create session\n        const session = await (0, ($parcel$interopDefault($9cHRR$axios)))(`/api/v1/booking/checkout-session/${tourId}`);\n        // 2)\n        await stripe.redirectToCheckout({\n            sessionId: session.data.session.id\n        });\n    } catch (err) {\n        (0, $528d70b6813c5801$export$de026b00723010c1)(\"error\", err);\n    }\n};\n\n\n\nconst $ab13a2a6d2405e8d$var$mapBox = document.getElementById(\"map\");\nconst $ab13a2a6d2405e8d$var$loginForm = document.querySelector(\".form--login\");\nconst $ab13a2a6d2405e8d$var$logOutBtn = document.querySelector(\".nav__el--logout\");\nconst $ab13a2a6d2405e8d$var$userDataForm = document.querySelector(\".form-user-data\");\nconst $ab13a2a6d2405e8d$var$userPasswordForm = document.querySelector(\".form-user-password\");\nconst $ab13a2a6d2405e8d$var$bookTourBtn = document.getElementById(\"book-tour\");\nconst $ab13a2a6d2405e8d$var$alertMessage = document.querySelector(\"body\").dataset.alert;\nconsole.log($ab13a2a6d2405e8d$var$loginForm);\nif ($ab13a2a6d2405e8d$var$mapBox) {\n    const locations = JSON.parse($ab13a2a6d2405e8d$var$mapBox.dataset.locations);\n    (0, $f1eefc3e571ce161$export$4c5dd147b21b9176)(locations);\n}\nif ($ab13a2a6d2405e8d$var$loginForm) $ab13a2a6d2405e8d$var$loginForm.addEventListener(\"submit\", (e)=>{\n    e.preventDefault();\n    const email = document.getElementById(\"email\").value;\n    const password = document.getElementById(\"password\").value;\n    console.log(email);\n    console.log(password);\n    (0, $90c6ea74aa9f1952$export$596d806903d1f59e)(email, password);\n});\nif ($ab13a2a6d2405e8d$var$logOutBtn) $ab13a2a6d2405e8d$var$logOutBtn.addEventListener(\"click\", (0, $90c6ea74aa9f1952$export$a0973bcfe11b05c9));\nif ($ab13a2a6d2405e8d$var$userDataForm) $ab13a2a6d2405e8d$var$userDataForm.addEventListener(\"submit\", async (e)=>{\n    e.preventDefault();\n    const form = new FormData();\n    form.append(\"name\", document.getElementById(\"name\").value);\n    form.append(\"email\", document.getElementById(\"email\").value);\n    form.append(\"photo\", document.getElementById(\"photo\").files[0]);\n    await (0, $57d5b9d949522b3d$export$f558026a994b6051)(form, \"data\");\n    location.reload();\n});\nif ($ab13a2a6d2405e8d$var$userPasswordForm) $ab13a2a6d2405e8d$var$userPasswordForm.addEventListener(\"submit\", async (e)=>{\n    e.preventDefault();\n    document.querySelector(\".btn--save-password\").textContent = \"Updating...\";\n    const passwordOld = document.getElementById(\"password-current\").value;\n    const passwordNew = document.getElementById(\"password\").value;\n    const passwordConfirm = document.getElementById(\"password-confirm\").value;\n    await (0, $57d5b9d949522b3d$export$f558026a994b6051)({\n        passwordOld: passwordOld,\n        passwordNew: passwordNew,\n        passwordConfirm: passwordConfirm\n    }, \"password\");\n    document.querySelector(\".btn--save-password\").textContent = \"Save password\";\n    // Clear input password fields\n    document.getElementById(\"password-current\").value = \"\";\n    document.getElementById(\"password\").value = \"\";\n    document.getElementById(\"password-confirm\").value = \"\";\n});\nif ($ab13a2a6d2405e8d$var$bookTourBtn) $ab13a2a6d2405e8d$var$bookTourBtn.addEventListener(\"click\", (e)=>{\n    e.preventDefault();\n    e.target.textContent = \"Processing\";\n    const { tourId: tourId  } = e.target.dataset;\n    console.log(tourId);\n    (0, $a3b283ce5068068c$export$8d5bdbf26681c0c2)(tourId);\n});\nif ($ab13a2a6d2405e8d$var$alertMessage) (0, $528d70b6813c5801$export$de026b00723010c1)(\"success\", $ab13a2a6d2405e8d$var$alertMessage, 20);\n\n\n//# sourceMappingURL=index.js.map\n","/* eslint-disable */\nimport '@babel/polyfill';\nimport { login, logout } from './login';\nimport { displayMap } from './mapbox';\nimport { updateSettings } from './updateSettings';\nimport { bookTour } from './stripe';\nimport { showAlert } from './alerts';\n\nconst mapBox = document.getElementById('map');\nconst loginForm = document.querySelector('.form--login');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst userDataForm = document.querySelector('.form-user-data');\nconst userPasswordForm = document.querySelector('.form-user-password');\nconst bookTourBtn = document.getElementById('book-tour');\nconst alertMessage = document.querySelector('body').dataset.alert;\n\nconsole.log(loginForm);\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\n\nif (loginForm) {\n  loginForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n\n    console.log(email);\n    console.log(password);\n\n    login(email, password);\n  });\n}\n\nif (logOutBtn) {\n  logOutBtn.addEventListener('click', logout);\n}\n\nif (userDataForm) {\n  userDataForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n\n    const form = new FormData();\n    form.append('name', document.getElementById('name').value);\n    form.append('email', document.getElementById('email').value);\n    form.append('photo', document.getElementById('photo').files[0]);\n\n    await updateSettings(form, 'data');\n\n    location.reload();\n  });\n}\n\nif (userPasswordForm) {\n  userPasswordForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\n\n    const passwordOld = document.getElementById('password-current').value;\n    const passwordNew = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n\n    await updateSettings(\n      { passwordOld, passwordNew, passwordConfirm },\n      'password'\n    );\n\n    document.querySelector('.btn--save-password').textContent = 'Save password';\n\n    // Clear input password fields\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n  });\n}\n\nif (bookTourBtn) {\n  bookTourBtn.addEventListener('click', (e) => {\n    e.preventDefault();\n    e.target.textContent = 'Processing';\n    const { tourId } = e.target.dataset;\n    console.log(tourId);\n    bookTour(tourId);\n  });\n}\n\nif (alertMessage) {\n  showAlert('success', alertMessage, 20);\n}\n","/* eslint-disable */\nimport axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const login = async (email, password) => {\n  try {\n    const result = await axios({\n      method: 'POST',\n      url: '/api/v1/users/login',\n      data: { email, password },\n    });\n\n    if (result.data.status === 'success') {\n      showAlert('success', 'Successfully logged in');\n      window.setTimeout(() => {\n        location.assign('/');\n      }, 1500);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n\nexport const logout = async () => {\n  try {\n    const res = await axios({\n      method: 'GET',\n      url: '/api/v1/users/logout',\n    });\n\n    if (res.data.status === 'success') {\n      location.assign('/');\n    }\n  } catch (err) {\n    showAlert('error', 'Error logging out. Try again');\n  }\n};\n","/* eslint-disable */\n\nexport const hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\nexport const showAlert = (type, message, time = 7) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${message}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  window.setTimeout(hideAlert, time * 1000);\n};\n","/* eslint-disable */\n\nexport const displayMap = (locations) => {\n  mapboxgl.accessToken =\n    'pk.eyJ1Ijoia2NodW1hayIsImEiOiJjbGliaDN3ZmowZGs3M3FtdGx2NGJma283In0.rCx_1fsTIq5B00zNmh_K3w';\n  var map = new mapboxgl.Map({\n    container: 'map',\n    style: 'mapbox://styles/kchumak/clibhc3jo02xq01png9uh6mui',\n    scrollZoom: false,\n    // center: [-118.340182, 34.054748],\n    // zoom: 10,\n    // interactive: false,\n  });\n\n  const bounds = new mapboxgl.LngLatBounds();\n\n  locations.forEach((loc) => {\n    // Create a marker\n    const el = document.createElement('div');\n    el.className = 'marker';\n\n    // Add a marker\n    new mapboxgl.Marker({\n      element: el,\n      anchor: 'bottom',\n    })\n      .setLngLat(loc.coordinates)\n      .addTo(map);\n\n    // Add a popup\n    new mapboxgl.Popup({\n      offset: 30,\n    })\n      .setLngLat(loc.coordinates)\n      .setHTML(`<p>Day ${loc.day}: ${loc.description} </p>`)\n      .addTo(map);\n\n    // extend ma bounds to include current location\n    bounds.extend(loc.coordinates);\n  });\n\n  map.fitBounds(bounds, {\n    padding: { top: 200, bottom: 200, left: 100, right: 100 },\n  });\n};\n","/* eslint-disable */\n\nimport axios from 'axios';\nimport { showAlert } from './alerts';\n\n// type is either a 'password' or 'data'\nexport const updateSettings = async (data, type) => {\n  console.log(data);\n  try {\n    const res = await axios({\n      method: 'PATCH',\n      url:\n        type === 'password'\n          ? '/api/v1/users/updatePassword'\n          : '/api/v1/users/updateMe',\n      data,\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', `${type.toUpperCase()} updated successfully`);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n","/* eslint-disable */\n\nimport axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const bookTour = async (tourId) => {\n  const stripe = Stripe(\n    'pk_test_51M9VYACOowI665uNB0ajKN8b4kqMTunVIJaeczMQm0RwYLzXQdkNuQOVJzCW7jSF54jtkCXG30vm0efkvnNutO3F00paMDAsCo'\n  );\n\n  try {\n    // 1) create session\n    const session = await axios(`/api/v1/booking/checkout-session/${tourId}`);\n    // 2)\n    await stripe.redirectToCheckout({\n      sessionId: session.data.session.id,\n    });\n  } catch (err) {\n    showAlert('error', err);\n  }\n};\n"],"names":["require","$9cHRR$axios","$parcel$interopDefault","a","__esModule","default","$528d70b6813c5801$export$516836c6a9dfc573","el","document","querySelector","parentElement","removeChild","$528d70b6813c5801$export$de026b00723010c1","type","message","time","markup","insertAdjacentHTML","window","setTimeout","$90c6ea74aa9f1952$export$596d806903d1f59e","email","password","result","method","url","data","status","location","assign","err","response","$90c6ea74aa9f1952$export$a0973bcfe11b05c9","res","$57d5b9d949522b3d$export$f558026a994b6051","console","log","toUpperCase","$a3b283ce5068068c$export$8d5bdbf26681c0c2","tourId","stripe","Stripe","session","redirectToCheckout","sessionId","id","$ab13a2a6d2405e8d$var$mapBox","getElementById","$ab13a2a6d2405e8d$var$loginForm","$ab13a2a6d2405e8d$var$logOutBtn","$ab13a2a6d2405e8d$var$userDataForm","$ab13a2a6d2405e8d$var$userPasswordForm","$ab13a2a6d2405e8d$var$bookTourBtn","$ab13a2a6d2405e8d$var$alertMessage","dataset","alert","locations","JSON","parse","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LngLatBounds","forEach","loc","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","bottom","left","right","addEventListener","e","preventDefault","value","form","FormData","append","files","reload","textContent","passwordOld","passwordNew","passwordConfirm","target"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}